<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DANTE 38433 | DIAMANTE PLUS</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        /* ESTILOS DE GRADO MILITAR */
        :root { --primary: #00ff41; --alert: #ff3333; --bg: #05070a; }
        body { background-color: var(--bg); color: var(--primary); font-family: 'Share Tech Mono', monospace; margin: 0; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; }
        .scan-line { position: fixed; top: 0; left: 0; width: 100%; height: 5px; background: rgba(0, 255, 65, 0.1); animation: scan 3s linear infinite; pointer-events: none; z-index: 10; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, rgba(0,0,0,0) 60%, rgba(0,0,0,0.8) 100%); pointer-events: none; z-index: 9; }
        @keyframes scan { 0% { top: -5%; } 100% { top: 105%; } }
        .container { width: 90%; max-width: 500px; border: 1px solid var(--primary); padding: 20px; background: rgba(0, 20, 0, 0.9); z-index: 2; text-align: center; box-shadow: 0 0 30px rgba(0,255,65,0.2); }
        h1 { font-size: 2em; text-shadow: 0 0 10px var(--primary); letter-spacing: 2px; margin-bottom: 20px; }
        .console-box { border: 1px dashed var(--primary); padding: 15px; margin: 20px 0; height: 150px; text-align: left; font-size: 0.85em; overflow-y: auto; color: #ccffcc; background: #000; }
        button { background: #001100; color: var(--primary); border: 1px solid var(--primary); padding: 15px; width: 100%; font-family: inherit; font-size: 1.2em; cursor: pointer; text-transform: uppercase; transition: 0.3s; margin-top: 10px; }
        button:hover { background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary); }
        .hidden { display: none !important; }
        .recording { animation: pulse 1s infinite; background: var(--alert) !important; color: #fff !important; border-color: var(--alert) !important; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
    </style>
</head>
<body>
    <div class="scan-line"></div>
    <div class="overlay"></div>
    <div class="container">
        <h1>SISTEMA DANTE<br><span style="font-size:0.6em; color:#fff;">[PROYECTO 38433]</span></h1>
        
        <div id="console" class="console-box">
            > SISTEMA DE ARRANQUE V3.0...<br>
            > ESPERANDO INICIALIZACI√ìN...
        </div>

        <div id="controls">
            <button id="btn-init" onclick="iniciarSistema()">>>> ACTIVAR VOZ</button>
            <button id="btn-talk" class="hidden" onmousedown="grabar()" onmouseup="enviar()" ontouchstart="grabar()" ontouchend="enviar()">üéôÔ∏è MANTENER PARA HABLAR</button>
        </div>
    </div>

    <script>
        // ==========================================
        // üîë ZONA DE LA FANTEKEY (MODIFICAR AQU√ç)
        // ==========================================
        const API_KEY = "TU_API_KEY_AQUI"; 
        // ==========================================

        const consola = document.getElementById('console');
        const btnInit = document.getElementById('btn-init');
        const btnTalk = document.getElementById('btn-talk');
        let mediaRecorder, audioChunks = [];

        function log(msg) { 
            consola.innerHTML += `> ${msg}<br>`; 
            consola.scrollTop = consola.scrollHeight; 
        }

        async function iniciarSistema() {
            if (API_KEY.includes("TU_API_KEY") || API_KEY.length < 10) {
                alert("‚ö†Ô∏è ERROR CR√çTICO: No has puesto la API KEY en el c√≥digo (L√≠nea 56).");
                return;
            }
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
                mediaRecorder.onstop = procesarAudio;
                
                btnInit.classList.add('hidden');
                btnTalk.classList.remove('hidden');
                log("SISTEMA ONLINE. MANT√âN EL BOT√ìN PARA HABLAR.");
                hablar("Sistema Dante en l√≠nea. Te escucho.");
            } catch (err) {
                log("ERROR DE MICR√ìFONO: Permiso denegado.");
            }
        }

        function grabar() {
            audioChunks = [];
            mediaRecorder.start();
            btnTalk.classList.add('recording');
            btnTalk.innerText = "ESCUCHANDO...";
        }

        function enviar() {
            mediaRecorder.stop();
            btnTalk.classList.remove('recording');
            btnTalk.innerText = "PROCESANDO...";
        }

        async function procesarAudio() {
            const blob = new Blob(audioChunks, { type: 'audio/webm' });
            const reader = new FileReader();
            reader.readAsDataURL(blob);
            reader.onloadend = async () => {
                const base64 = reader.result.split(',')[1];
                log("ENVIANDO A GEMINI...");
                
                try {
                    const req = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                        method: "POST", headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            system_instruction: { parts: [{ text: "Eres Dante, un asistente mexicano rudo y directo." }] },
                            contents: [{ parts: [{ inline_data: { mime_type: "audio/webm", data: base64 } }, { text: "Responde brevemente." }] }]
                        })
                    });
                    const res = await req.json();
                    if (res.error) throw new Error(res.error.message);
                    
                    const texto = res.candidates[0].content.parts[0].text;
                    log(`DANTE: ${texto}`);
                    hablar(texto);
                    btnTalk.innerText = "üéôÔ∏è MANTENER PARA HABLAR";
                } catch (e) {
                    log(`ERROR API: ${e.message}`);
                    btnTalk.innerText = "ERROR DE CONEXI√ìN";
                }
            };
        }

        function hablar(tx) {
            const ut = new SpeechSynthesisUtterance(tx);
            ut.rate = 1.1;
            const v = window.speechSynthesis.getVoices().find(v => v.lang === 'es-MX');
            if (v) ut.voice = v;
            window.speechSynthesis.speak(ut);
        }
    </script>
</body>
</html>
    "Ika": {b:"1100", v:"Poder", d:"Maldad"}, "Oturupon": {b:"0011", v:"Salud", d:"Enfermedad"},
    "Otura": {b:"1011", v:"Verdad", d:"Confusi√≥n"}, "Irete": {b:"0010", v:"Presi√≥n", d:"Crueldad"},
    "Ose": {b:"1101", v:"Amor", d:"Celos"}, "Ofun": {b:"0001", v:"Milagro", d:"Avaricia"}
};

function ejecutarEngine() {
    const seed = document.getElementById('seed').value;
    const moodInput = document.getElementById('mood').value.toLowerCase();
    const out = document.getElementById('output');

    if(!/^\d{8}$/.test(seed)) {
        out.style.display = "block";
        out.style.borderColor = "#ff3333";
        out.style.color = "#ff3333";
        out.innerHTML = "‚ùå ERROR: Ingresa 8 d√≠gitos (YYYYMMDD).";
        return;
    }

    const iP1 = parseInt(seed.slice(-2)) % 16;
    const iP2 = parseInt(seed.slice(4,6)) % 16;
    const padre = ODU_KEYS[iP1];
    const madre = ODU_KEYS[iP2];

    let zona = { n: "NEUTRAL", c: "#f1c40f", j: "Virgilio" };
    if(moodInput.match(/feliz|bien|amor|paz|luz/)) zona = { n: "CREDULIDAD", c: "#ff00ff", j: "Dionisio" };
    else if(moodInput.match(/dios|poder|yo|mando|ego/)) zona = { n: "EGO", c: "#00d4ff", j: "Zeus" };
    else if(moodInput.match(/miedo|triste|no se|mal|duda/)) zona = { n: "IGNORANCIA", c: "#00ff41", j: "Tezcatlipoca" };

    localStorage.setItem("dante_last_seed", seed);
    localStorage.setItem("dante_last_zone", zona.n);

    document.body.style.borderColor = zona.c;
    out.style.display = "block";
    out.style.borderColor = zona.c;
    out.style.color = zona.c;
    out.innerHTML = `
[VIRGILIO]: Frecuencia Anclada.
--------------------------------
üÜî ODU: ${padre}-${madre}
üíæ BIN: ${ODU_DB[padre].b}::${ODU_DB[madre].b}
‚ú® VIRTUD: ${ODU_DB[padre].v} + ${ODU_DB[madre].v}
üíÄ SOMBRA: ${ODU_DB[padre].d} + ${ODU_DB[madre].d}
üìç ESTADO: ZONA ${zona.n}
‚ö†Ô∏è JEFE: ${zona.j}
--------------------------------
[SISTEMA DIAMANTE GUARDADO]`;
}
</script>
</body>
</html>
